set -g default-terminal "xterm-256color"
set-option -sa terminal-overrides ",xterm-256color:Tc"
set -g status-fg white
set -g status-bg "#2F2D2D"
set -g status-left " #[fg=#ffefd5] #S "
set -g status-left-length 100
set -g status-left-style default
set -g status-right-length 100
set -g status-right-style default
set -g status-right "#[fg=#ffefd5]󱦥  "
set -g display-panes-time 100
set-window-option -g aggressive-resize on
set-window-option -g window-status-current-style "bg=#222930 fg=white"
set-option -g escape-time 0

set-hook -g after-new-window "run-shell '~/.config/scripts/tmux_renumber_windows.sh'"
set-hook -g after-kill-pane  "run-shell '~/.config/scripts/tmux_renumber_windows.sh'"

bind-key -n F2 new-window -c "#{pane_current_path}" \; rename-window " "
bind-key -n C-F2 display-panes \; split-window -h -c "#{pane_current_path}"
bind-key -n S-F2 display-panes \; split-window -v -c "#{pane_current_path}"
bind-key -n M-Left previous-window
bind-key -n M-Right next-window
bind-key -n F3 run-shell '$HOME/.config/scripts/tmux_switch_session.py'
bind-key -n S-F3 switch-client -n
bind-key -n F4 if-shell '[ $(tmux list-panes | wc -l) -gt 1 ]' "if-shell '[ $(tmux list-panes | grep active | cut -c1-1) = 1 ]' 'select-pane -U \; resize-pane -Z' 'select-pane -D'" 'split-window -v -p 40 -c "#{pane_current_path}"'
bind-key -n S-Up display-panes \; select-pane -U
bind-key -n S-Down display-panes \; select-pane -D
bind-key -n S-Left display-panes \; select-pane -L
bind-key -n S-Right display-panes \; select-pane -R
bind-key -n M-S-Up resize-pane -U
bind-key -n M-S-Down resize-pane -D
bind-key -n M-S-Left resize-pane -L
bind-key -n M-S-Right resize-pane -R

bind-key -n F6 if-shell '[ "#{pane_current_command}" != "bash" ] && [ "#{pane_current_command}" != "zsh" ] && [ "#{pane_current_command}" != "fish" ]' \
    "confirm-before -p 'kill-pane #P? (y/n)' kill-pane" \
    "kill-pane"

bind-key -n F8 command-prompt -p "(rename-window) " "rename-window '%% '"
bind-key -n S-F11 resize-pane -Z
bind-key -n M-F11 break-pane
bind-key -n C-F11 join-pane -h -s :. -t :-1

bind-key -n M-0 select-window -t 0
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# Bind F5 to open Yazi in a popup
bind-key -n F5 run-shell "$HOME/.config/scripts/tmux_toggle_session_popup.sh 'yazi_session' '#{pane_current_path}' yazi"

# Bind F7 to open python interactive repl
bind-key -n F7 run-shell "$HOME/.config/scripts/tmux_toggle_session_popup.sh 'repl_session' '#{pane_current_path}' $HOME/.config/scripts/repl.py"

set -g mouse on
setw -g mode-keys vi
set-option -g set-clipboard on
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -in"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -in"
bind PgUp send-keys -X scroll-up
bind PgDn send-keys -X scroll-down
